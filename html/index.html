<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Contact_Line_Advection_Level_Set: Contact Line Advection using the Level Set Method</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sfb1194.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Contact_Line_Advection_Level_Set
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Solving the contact line advection problem with the level set method</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Contact Line Advection using the Level Set Method </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This demonstrator software uses a Finite Volume based discretization of the hyperbolic level set transport equation to solve for the evolution of an interface being in contact with the domain boundary. The present implementation has been used to produce the results in the manuscript [1], which will be published in the Proceedings in Applied Mathematics and Mechanics (<a href="https://onlinelibrary.wiley.com/journal/16177061">https://onlinelibrary.wiley.com/journal/16177061</a>). An additional publication concerning the contact line advection with the Volume-of-Fluid method is in preparation [4].</p>
<p>Within the level set method (see, e.g. [5]), the interface is represented as the zero contour of some smooth function, i.e. the interface at time t is given as the set</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Sigma(t) = \{x \in \Omega: \phi(t,x) = 0 \}. \]" src="form_5.png"/>
</p>
<p>The interface is advected by a prescribed velocity field v according to the evolution equation</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t \phi + v \cdot \nabla \phi = 0. \]" src="form_2.png"/>
</p>
<p>This problem emerges from the discretization of continuum models for dynamic wetting, where the velocity field is a solution of the two-phase Navier Stokes equations. Here we are interested in the time evolution of both the <em>contact line</em>, i.e. the line of contact of the interface and the domain boundary, and the <em>contact angle</em> which is the angle of intersection between the interface and the boundary. In the Journal publications [2] and [3], we proved a fundamental kinematic relationship between the rate of change of the contact angle and the transporting velocity field. The kinematic evolution equation serves as a reference to validate the numerical solution of the level set equation in terms of the contact line position and the contact angle.</p>
<p>The method is capable of solving the transport equation in both two and three dimensions, while the automatic evaluation of the contact angle over time is currently only implemented for the two-dimensional case.</p>
<p><b>Note</b>: A html version of this documentation is available, see [readme.html].</p>
<h3>Authors of the software</h3>
<ul>
<li>Mathis Fricke (<a href="#" onclick="location.href='mai'+'lto:'+'fri'+'ck'+'e@m'+'ma'+'.tu'+'-d'+'arm'+'st'+'adt'+'.d'+'e'; return false;">frick<span style="display: none;">.nosp@m.</span>e@mm<span style="display: none;">.nosp@m.</span>a.tu-<span style="display: none;">.nosp@m.</span>darm<span style="display: none;">.nosp@m.</span>stadt<span style="display: none;">.nosp@m.</span>.de</a>), Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
<li>Tomislav Marić (<a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ic'+'@mm'+'a.'+'tu-'+'da'+'rms'+'ta'+'dt.'+'de'; return false;">maric<span style="display: none;">.nosp@m.</span>@mma<span style="display: none;">.nosp@m.</span>.tu-d<span style="display: none;">.nosp@m.</span>arms<span style="display: none;">.nosp@m.</span>tadt.<span style="display: none;">.nosp@m.</span>de</a>), Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
<li>Aleksandar Vučković (<a href="#" onclick="location.href='mai'+'lto:'+'ale'+'ks'+'and'+'ar'+'.vu'+'ck'+'ovi'+'c@'+'stu'+'d.'+'tu-'+'da'+'rms'+'ta'+'dt.'+'de'; return false;">aleks<span style="display: none;">.nosp@m.</span>anda<span style="display: none;">.nosp@m.</span>r.vuc<span style="display: none;">.nosp@m.</span>kovi<span style="display: none;">.nosp@m.</span>c@stu<span style="display: none;">.nosp@m.</span>d.tu<span style="display: none;">.nosp@m.</span>-darm<span style="display: none;">.nosp@m.</span>stad<span style="display: none;">.nosp@m.</span>t.de</a>), Student at Mathematical Modeling and Analysis, TU Darmstadt, Germany</li>
</ul>
<h3>References</h3>
<ul>
<li>[1] M. Fricke, T. Marić and D. Bothe: Contact Line Advection using the Level Set Method, Proceedings in Applied Mathematics and Mechanics, accepted for publication</li>
<li>[2] M. Fricke, M. Köhne and D. Bothe: A Kinematic Evolution Equation for the Dynamic Contact Angle and some Consequences. Physica D: Nonlinear Phenomena, 394:26–43, [<a href="https://doi.org/10.1016/j.physd.2019.01.008">https://doi.org/10.1016/j.physd.2019.01.008</a>] (2019)</li>
<li>[3] M. Fricke, M. Köhne and D. Bothe: On the Kinematics of Contact Line Motion, Proceedings in Applied Mathematics and Mechanics, [<a href="https://doi.org/10.1002/pamm.201800451">https://doi.org/10.1002/pamm.201800451</a>] (2018)</li>
<li>[4] M. Fricke, T. Marić and D. Bothe: Contact Line Advection using the geometrical Volume-of-Fluid Method, in preparation</li>
<li>[5] Y. Giga: Surface Evolution Equations: A Level set Approach, in: Monographs in Mathematics, vol. 99, Birkhäuser, Basel, [<a href="http://dx.doi.org/10.1007/3-7643-7391-1">http://dx.doi.org/10.1007/3-7643-7391-1</a>] (2006)</li>
<li>[6] R. J. LeVeque. Finite Volume Methods for Hyperbolic Problems. Cambridge University Press, Cambridge, [<a href="https://doi.org/10.1017/CBO9780511791253">https://doi.org/10.1017/CBO9780511791253</a>] (2002).</li>
</ul>
<p>Note that [2] is also available on the arXiv preprint server, see [<a href="https://arxiv.org/abs/1810.00830">https://arxiv.org/abs/1810.00830</a>].</p>
<h2>Installation</h2>
<h3>Dependencies</h3>
<p>The software is most easily compiled on a Unix system using the GNU compiler. It has also been tested successfully on Windows 10 using the <em>MinGW</em> project ([<a href="http://www.mingw.org/">http://www.mingw.org/</a>]).</p>
<ul>
<li>g++ (GCC) 6.1</li>
<li>make</li>
<li>ParaView for Visualization</li>
</ul>
<p>In order to rebuild the documentation from the source code, one further needs the software <em>doxygen</em> which is available for all platforms (see [<a href="http://www.doxygen.nl">http://www.doxygen.nl</a>]).</p>
<h3>Compiling the software</h3>
<p>On a Unix system enter the src/ directory and run make: </p><pre class="fragment">cd src/
make
</pre><p>If the program is compiled properly, you will find an executable called "cl_advection" in the src/ folder.</p>
<h2>Usage</h2>
<p>To run the program, go to a testcase folder (containing a file named "Inputfile") and execute </p><pre class="fragment">cl_advection
</pre><p>Within the same directory, you will find the files contactAngle.csv and position.csv. The first column represents the simulation time, the second is the actual value and the third is the reference value. You will find a folder named data/ as well. It will contain the binary files of the field, its level set value, velocity field and the XMF file necessary to visualize everything in Paraview (version 5.5 and higher).</p>
<h3>Inputfile</h3>
<p>All parameters in the Inputfile need to be set in order for the program to work correctly. The physical parameters have arbitrary units.</p>
<table class="doxtable">
<tr>
<th>Variable name </th><th>Description  </th></tr>
<tr>
<td>numX, numY, numZ</td><td>Number of cells in the given direction. </td></tr>
<tr>
<td>lenX, lenY, lenZ</td><td>Length of simulation domain in the coordinate directions. </td></tr>
<tr>
<td>time </td><td>The total simulation time. </td></tr>
<tr>
<td>CFL </td><td>Courant-Friedrichs-Lewy-number (determines the numerical timestep). CFL has to be set between 0 and 1 to ensure stability of the numerical method. </td></tr>
<tr>
<td>writestepsFraction </td><td>Fraction of total timesteps that will be written to disk. </td></tr>
<tr>
<td>writeField</td><td>Whether to write the level set field binary files to disk. The files contactAngle.csv and position.csv are always written (see below). </td></tr>
<tr>
<td>field </td><td>The velocity field that is used to transport the interface. By default, the possible choices are "navierField", "shearField", "timeDependentNavierField". </td></tr>
<tr>
<td>v0, c1, c2 </td><td>The field parameters. For the Navier field all three parameters are relevant, but for the shear field, c1 and c2 are ignored and only the value of v0 matters. </td></tr>
<tr>
<td>tau </td><td>Parameter for the field "timeDependentNavierField" (see examples below). </td></tr>
<tr>
<td>centerX, centerY, centerZ </td><td>The initial center of the droplet. </td></tr>
<tr>
<td>expcpX, expcpY, expcpZ, expAngle </td><td>The expected coordinates for the initial contact point and the expected initial contact angle. Those are used for the reference solutions. </td></tr>
<tr>
<td>trackedContactPoint </td><td>Whether to track the left or right contact point. Only applicable in 2D. </td></tr>
</table>
<h3>Visualization</h3>
<p>To visualize the data with <em>Paraview</em> [<a href="https://www.paraview.org">https://www.paraview.org</a>], open the file "Phi.xmf" within Paraview. Choose "Xdmf Reader", then press "Apply". In order to visualize the interface, choose "Rescale to Custom Data Range" and select appropriate scaling values, e.g. -0.001 to 0.001. Now, select "Play" at the top.</p>
<p>To visualize the velocity field, choose the filter "Glyph", then change the Maximum Number of Sample Points (section "Masking") to a smaller value, e.g. 500. To ensure correct scaling of the vector field, choose "Scale Array" as "Velocity Field" and "Vector Scale Mode" as "Scale by Magnitude".</p>
<h2>Implementation</h2>
<p>The numerical method is based on an Explicit Euler Finite Volume Method on a regular cartesian grid. The first-order upwind method is used to compute the numerical fluxes over the cell edges (see, e.g. [6] chapter 4.9).</p>
<p>The program is structured into six files.</p>
<table class="doxtable">
<tr>
<th>File name </th><th>Description  </th></tr>
<tr>
<td><a class="el" href="main_8cpp.html">main.cpp</a> </td><td>Reads the Inputfile and handles the top-level loop which evolves the field with time. </td></tr>
<tr>
<td>Field.cpp/hpp </td><td>The fundamental field class. Each instance of field represents an equidistant grid of any type parameter. </td></tr>
<tr>
<td>LevelSet.cpp/hpp </td><td>This class extends <a class="el" href="class_field.html" title="The template for the abstract field class. ">Field</a>, instantiated with "double" as its type parameter and obviously represents the levelset field. <br />
It is contains most of the important methods such as <a class="el" href="class_level_set.html#a5d3fb6f7df4bba4a47c4ba437bf9ee57">calculatedNextTimestep</a> and <a class="el" href="class_level_set.html#a5aacda3799b59321b249369cfcd8d50f">getContactAngle</a>. An object of class <a class="el" href="class_level_set.html" title="The class of the Level set field. ">LevelSet</a> is instantiated at the beginning within the <a class="el" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="The main function of the program. ">main()</a> function. </td></tr>
<tr>
<td>VelocityField.cpp/hpp </td><td>An object of class <a class="el" href="class_velocity_field.html" title="The class of the velocity field acting on the Level set field. ">VelocityField</a> represents a chosen velocity field. It is aware of its parameters type (for example whether it is a shear field with v0 = 2) and the domain it is applicable on. </td></tr>
<tr>
<td>velocityFields.cpp/hpp </td><td>This is a library that contains the definitions of the velocity fields. </td></tr>
<tr>
<td>vecMath3D.cpp/hpp </td><td>This is a library of operator overloads and functions for vector analysis. </td></tr>
</table>
<h3>Adding a new velocity field</h3>
<p>To add a new velocity field, add itself and its Jacobian matrix to the files <em>velocityFields.cpp</em> and <em><a class="el" href="velocity_fields_8hpp_source.html">velocityFields.hpp</a></em>. Next, add the appropriate if-statement to the <a class="el" href="class_velocity_field.html#a767fce45fffffeab12e72647618c213c" title="Evaluates the velocity field at the given point. ">VelocityField::at</a> member function.</p>
<h2>Examples</h2>
<p>In the following, we will consider three examples and verify the numerical results with the kinematic evolution equation (see [2],[3])</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dfrac{D n_{\Sigma}}{Dt} = - (\nabla v)^{\intercal} n_{\Sigma} + \langle \nabla v \cdot n_{\Sigma}, n_{\Sigma} \rangle \, n_{\Sigma}, \]" src="form_20.png"/>
</p>
<p>where <img class="formulaInl" alt="$ n_{\Sigma} $" src="form_7.png"/> is the normal vector at the contact point and <img class="formulaInl" alt="$ \dfrac{D}{Dt} $" src="form_8.png"/> is the Lagrangian derivative.</p>
<h3>Navier slip type field (src/testcases/navier)</h3>
<p>The Navier slip field is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ v(x,y) = (v_0 + c_1 x + c_2 y, -c_1 y), \]" src="form_21.png"/>
</p>
<p>where <img class="formulaInl" alt="$v_0, c_1$" src="form_10.png"/> and <img class="formulaInl" alt="$c_2 $" src="form_11.png"/> correspond to v0, c1 and c2 defined above. As it is evident from the plots of the contact angle and position, the results of the simulation are in agreement with the analytic solution. The latter is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_1(t) = x_1^0 e^{c_1 t} + \dfrac{v_0}{c_1} (e^{c_1 t} - 1), \qquad \theta (t) = \dfrac{\pi}{2} + \arctan(-\cot\theta_0 e^{2c_1 t} \pm c_2 \dfrac{e^{2c_1 t} - 1}{2c_1}), \quad c_1 \neq 0, \]" src="form_22.png"/>
</p>
<p>where <img class="formulaInl" alt="$ ``-``$" src="form_13.png"/> is used for the left contact point and <img class="formulaInl" alt="$ ``+``$" src="form_14.png"/> is for the right contact point.</p>
<p>Further, one observes from the plots of the errors that the numerical solution converges to the analytical solution with first-order accuracy.</p>
<div class="image">
<img src="images/results_angle_navier.jpg"  alt="Contact Angle Evolution for the Navier testcase."/>
</div>
<div class="image">
<img src="images/error_angle_navier.jpg"  alt="Contact Angle Error for the Navier testcase."/>
</div>
<div class="image">
<img src="images/results_position_navier.jpg"  alt="Contact Line Position for the Navier testcase."/>
</div>
<div class="image">
<img src="images/error_position_navier.jpg"  alt="Position Error for the Navier testcase."/>
</div>
<h3>Vortex-in-a-box field (src/testcases/shear)</h3>
<p>The vortex-in-a-box field, also known as the shear field, is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ v(x,y) = (-\sin(\pi x)\cos(\pi y), \cos(\pi x) \sin(\pi y) ). \]" src="form_23.png"/>
</p>
<p>Similarly to the Navier field above, we again find that the numerical results agree well with the reference solution. For the reference solution, we solved the equation above numerically with the explicit euler method.</p>
<div class="image">
<img src="images/results_angle_shear.jpg"  alt="Contact Angle Evolution for the shear testcase."/>
</div>
<div class="image">
<img src="images/error_angle_shear.jpg"  alt="Contact Angle Error for the shear testcase."/>
</div>
<div class="image">
<img src="images/results_position_shear.jpg"  alt="Contact Line Position for the shear testcase."/>
</div>
<div class="image">
<img src="images/error_position_shear.jpg"  alt="Position Error for the shear testcase."/>
</div>
<div class="image">
<img src="images/snapshotShear.png"  alt="A snapshot of the simulation"/>
</div>
<h3>Time-dependent field (src/testcases/timeDependentNavier)</h3>
<p>The time-depentent Navier field is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ v(x,y) = \dfrac{\cos(\pi t)}{\tau} \cdot (v_0 + c_1 x + c_2 y, -c_y y). \]" src="form_24.png"/>
</p>
<p>As expected, both the values in the contact angle and the position oscillate with a constant period. The results for the contact angle and position agree well with the analytical solution</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_1(t) = x_1^0 e^{c_1 s(t)} + \dfrac{v_0}{c_1} (e^{c_1 s(t)} - 1), \]" src="form_25.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta (t) = \dfrac{\pi}{2} + \arctan(-\cot\theta_0 e^{2c_1 s(t)} \pm c_2 \dfrac{e^{2c_1 s(t)} - 1}{2c_1}), \quad c_1 \neq 0,\]" src="form_26.png"/>
</p>
<p>where</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ s(t) = \dfrac{\tau}{\pi}\sin(\dfrac{\pi}{\tau}t). \]" src="form_27.png"/>
</p>
<p>Again, we can verify linear convergence of the results.</p>
<div class="image">
<img src="images/results_angle_time_dependent_navier.jpg"  alt="Contact Angle Evolution for the time-dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/error_angle_time_dependent_navier.jpg"  alt="Contact Angle Error for the time-dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/results_position_time_dependent_navier.jpg"  alt="Contact Line Position for the time-dependent Navier testcase."/>
</div>
<div class="image">
<img src="images/error_position_time_dependent_navier.jpg"  alt="Position Error for the time-dependent Navier testcase."/>
</div>
<center><video src="images/animation.ogv" controls></video></center><h2>License</h2>
<p>This project is licensed under the GNU GENERAL PUBLIC LICENSE v3.</p>
<h2>Acknowledgments</h2>
<p>We kindly acknowledge the financial support by the German Research Foundation (DFG) within the Collaborative Research Centre 1194 “Interaction of Transport and Wetting Processes”, Projects B01 and Z-INF. Calculations for this research were conducted on the Lichtenberg high performance computer of the TU Darmstadt. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
